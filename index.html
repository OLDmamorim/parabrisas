<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Expressglass â€” GestÃ£o Material</title>
  <style>
    /* (â€¦ todo o CSS da tua pÃ¡gina â€¦) */

    /* ===== Estilos do modal de exportaÃ§Ã£o ===== */
    .export-modal{ position: fixed; inset:0; background: rgba(0,0,0,.7); display:none; align-items:center; justify-content:center; z-index:1200; backdrop-filter: blur(6px); padding:16px; }
    .export-modal.show{ display:flex }
    .export-modal-content{ width:100%; max-width:520px; background: var(--card,#0f172a); color:var(--text,#e5e7eb); border:1px solid var(--cardBorder,#1f2937); border-radius:16px; box-shadow: 0 20px 40px rgba(0,0,0,.35); display:flex; flex-direction:column; overflow:hidden; animation: modalSlideIn .25s ease; }
    @keyframes modalSlideIn{ from{ transform: translateY(10px); opacity:.6 } to{ transform:none; opacity:1 } }
    .export-modal-header{ display:flex; align-items:center; justify-content:space-between; padding:16px 20px; border-bottom:1px solid var(--cardBorder,#1f2937); }
    .export-modal-header h3{ margin:0; font-size:18px; color: #22d3ee }
    .export-close{ background:none; border:0; color:#a3aed0; font-size:24px; cursor:pointer; line-height:1; border-radius:8px; padding:2px 6px; }
    .export-close:hover{ color:#fff; background: rgba(255,255,255,.08) }
    .export-modal-body{ padding:16px 20px; display:grid; gap:12px }
    .export-field{ display:grid; gap:6px }
    .export-field.inline{ display:flex; align-items:center; }
    .export-field label{ font-weight:600; font-size:14px; color:#a3aed0 }
    .export-field input[type="date"]{ background: rgba(255,255,255,.06); border:1px solid var(--cardBorder,#1f2937); color:var(--text,#e5e7eb); border-radius:10px; padding:10px 12px; font-size:14px; }
    .export-modal-footer{ display:flex; gap:10px; justify-content:flex-end; padding:16px 20px; border-top:1px solid var(--cardBorder,#1f2937); }
    .btn-secondary{ background:#6b7280; color:white; border:none; padding:10px 16px; border-radius:10px; cursor:pointer; }
    .btn-primary{ background:#06b6d4; color:white; border:none; padding:10px 16px; border-radius:10px; cursor:pointer; font-weight:700; }
    .btn-primary:hover{ filter:brightness(1.05); }

    /* Presets */
    .export-presets{ display:flex; gap:8px; flex-wrap:wrap; margin: 4px 0 6px; }
    .btn-chip{ background:#0ea5e9; border:none; color:white; padding:6px 10px; border-radius:999px; cursor:pointer; font-weight:700; }
    .btn-chip:hover{ filter:brightness(1.05); }
  </style>
</head>
<body>
  <!-- (â€¦ resto do teu HTML â€¦) -->

  <!-- BotÃ£o da toolbar -->
  <button id="btnExport" class="btn" onclick="window.openExportModal && window.openExportModal()">ðŸ“Š Exportar Excel</button>

  <!-- ===== MODAL EXPORTAÃ‡ÃƒO PARA EXCEL ===== -->
  <div id="exportModal" class="export-modal" style="display:none;">
    <div class="export-modal-content">
      <div class="export-modal-header">
        <h3>ðŸ“¤ Exportar para Excel</h3>
        <button id="exportModalClose" class="export-close" title="Fechar">Ã—</button>
      </div>
      <div class="export-modal-body">
        <div class="export-field">
          <label for="exportStart">Data inÃ­cio</label>
          <input id="exportStart" type="date" />
        </div>
        <div class="export-field">
          <label for="exportEnd">Data fim</label>
          <input id="exportEnd" type="date" />
        </div>
        <div class="export-presets">
          <button type="button" id="exportPresetHoje"   class="btn-chip">Hoje</button>
          <button type="button" id="exportPreset7"      class="btn-chip">Ãšltimos 7 dias</button>
          <button type="button" id="exportPresetMes"    class="btn-chip">Este mÃªs</button>
          <button type="button" id="exportPresetTodos"  class="btn-chip">Todos</button>
        </div>
        <div class="export-field inline">
          <label class="inline-label">
            <input id="exportUseSearch" type="checkbox" checked />
            Usar tambÃ©m o filtro de pesquisa atual (Eurocode/Marca)
          </label>
        </div>
      </div>
      <div class="export-modal-footer">
        <button id="exportModalCancel" class="btn-secondary">Cancelar</button>
        <button id="exportModalConfirm" class="btn-primary">Exportar</button>
      </div>
    </div>
  </div>

  <!-- SheetJS deve vir antes do app.js -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script src="app.js?v=presets-final"></script>
</body>
</html>